
<!-- saved from url=(0058)http://threejs.org/examples/misc_controls_pointerlock.html -->
<html><body><div class="webkit-line-gutter-backdrop"></div><table><tbody><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;html&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;head&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;meta <span class="webkit-html-attribute-name">charset</span>="<span class="webkit-html-attribute-value">utf-8</span>"&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;title&gt;</span>three.js - pointerlock controls<span class="webkit-html-tag">&lt;/title&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;style&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			html, body {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				width: 100%;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				height: 100%;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			body {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				background-color: #ffffff;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				margin: 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				overflow: hidden;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				font-family: arial;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			#blocker {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				position: absolute;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				width: 100%;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				height: 100%;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				background-color: rgba(0,0,0,0.5);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			#instructions {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				width: 100%;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				height: 100%;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				display: -webkit-box;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				display: -moz-box;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				display: box;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				-webkit-box-orient: horizontal;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				-moz-box-orient: horizontal;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				box-orient: horizontal;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				-webkit-box-pack: center;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				-moz-box-pack: center;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				box-pack: center;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				-webkit-box-align: center;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				-moz-box-align: center;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				box-align: center;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				color: #ffffff;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				text-align: center;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				cursor: pointer;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;/style&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;/head&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;body&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">src</span>="<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://threejs.org/build/three.min.js">../build/three.min.js</a>"&gt;</span><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">src</span>="<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://threejs.org/examples/js/controls/PointerLockControls.js">js/controls/PointerLockControls.js</a>"&gt;</span><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;div <span class="webkit-html-attribute-name">id</span>="<span class="webkit-html-attribute-value">blocker</span>"&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			<span class="webkit-html-tag">&lt;div <span class="webkit-html-attribute-name">id</span>="<span class="webkit-html-attribute-value">instructions</span>"&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				<span class="webkit-html-tag">&lt;span <span class="webkit-html-attribute-name">style</span>="<span class="webkit-html-attribute-value">font-size:40px</span>"&gt;</span>Click to play<span class="webkit-html-tag">&lt;/span&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				<span class="webkit-html-tag">&lt;br /&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				(W, A, S, D = Move, SPACE = Jump, MOUSE = Look around)</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			<span class="webkit-html-tag">&lt;/div&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;/div&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var camera, scene, renderer;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var geometry, material, mesh;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var controls;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var objects = [];</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var ray;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var blocker = document.getElementById( 'blocker' );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var instructions = document.getElementById( 'instructions' );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			// http://www.html5rocks.com/en/tutorials/pointerlock/intro/</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var havePointerLock = 'pointerLockElement' in document || 'mozPointerLockElement' in document || 'webkitPointerLockElement' in document;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			if ( havePointerLock ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				var element = document.body;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				var pointerlockchange = function ( event ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					if ( document.pointerLockElement === element || document.mozPointerLockElement === element || document.webkitPointerLockElement === element ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						controls.enabled = true;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						blocker.style.display = 'none';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					} else {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						controls.enabled = false;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						blocker.style.display = '-webkit-box';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						blocker.style.display = '-moz-box';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						blocker.style.display = 'box';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						instructions.style.display = '';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				var pointerlockerror = function ( event ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					instructions.style.display = '';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				// Hook pointer lock state change events</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				document.addEventListener( 'pointerlockchange', pointerlockchange, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				document.addEventListener( 'mozpointerlockchange', pointerlockchange, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				document.addEventListener( 'webkitpointerlockchange', pointerlockchange, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				document.addEventListener( 'pointerlockerror', pointerlockerror, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				document.addEventListener( 'mozpointerlockerror', pointerlockerror, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				document.addEventListener( 'webkitpointerlockerror', pointerlockerror, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				instructions.addEventListener( 'click', function ( event ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					instructions.style.display = 'none';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					// Ask the browser to lock the pointer</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					element.requestPointerLock = element.requestPointerLock || element.mozRequestPointerLock || element.webkitRequestPointerLock;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					if ( /Firefox/i.test( navigator.userAgent ) ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						var fullscreenchange = function ( event ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">							if ( document.fullscreenElement === element || document.mozFullscreenElement === element || document.mozFullScreenElement === element ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">								document.removeEventListener( 'fullscreenchange', fullscreenchange );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">								document.removeEventListener( 'mozfullscreenchange', fullscreenchange );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">								element.requestPointerLock();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">							}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						document.addEventListener( 'fullscreenchange', fullscreenchange, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						document.addEventListener( 'mozfullscreenchange', fullscreenchange, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						element.requestFullscreen = element.requestFullscreen || element.mozRequestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						element.requestFullscreen();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					} else {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						element.requestPointerLock();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			} else {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				instructions.innerHTML = 'Your browser doesn\'t seem to support Pointer Lock API';</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			init();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			animate();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			function init() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 1000 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				scene = new THREE.Scene();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				scene.fog = new THREE.Fog( 0xffffff, 0, 750 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				var light = new THREE.DirectionalLight( 0xffffff, 1.5 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				light.position.set( 1, 1, 1 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				scene.add( light );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				var light = new THREE.DirectionalLight( 0xffffff, 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				light.position.set( -1, - 0.5, -1 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				scene.add( light );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				controls = new THREE.PointerLockControls( camera );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				scene.add( controls.getObject() );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				ray = new THREE.Raycaster();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				ray.ray.direction.set( 0, -1, 0 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				// floor</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				geometry = new THREE.PlaneGeometry( 2000, 2000, 100, 100 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				geometry.applyMatrix( new THREE.Matrix4().makeRotationX( - Math.PI / 2 ) );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				for ( var i = 0, l = geometry.vertices.length; i &lt; l; i ++ ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					var vertex = geometry.vertices[ i ];</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					vertex.x += Math.random() * 20 - 10;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					vertex.y += Math.random() * 2;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					vertex.z += Math.random() * 20 - 10;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				for ( var i = 0, l = geometry.faces.length; i &lt; l; i ++ ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					var face = geometry.faces[ i ];</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					face.vertexColors[ 0 ] = new THREE.Color().setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					face.vertexColors[ 1 ] = new THREE.Color().setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					face.vertexColors[ 2 ] = new THREE.Color().setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				material = new THREE.MeshBasicMaterial( { vertexColors: THREE.VertexColors } );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				mesh = new THREE.Mesh( geometry, material );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				scene.add( mesh );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				// objects</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				geometry = new THREE.BoxGeometry( 20, 20, 20 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				for ( var i = 0, l = geometry.faces.length; i &lt; l; i ++ ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					var face = geometry.faces[ i ];</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					face.vertexColors[ 0 ] = new THREE.Color().setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					face.vertexColors[ 1 ] = new THREE.Color().setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					face.vertexColors[ 2 ] = new THREE.Color().setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				for ( var i = 0; i &lt; 500; i ++ ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					material = new THREE.MeshPhongMaterial( { specular: 0xffffff, shading: THREE.FlatShading, vertexColors: THREE.VertexColors } );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					var mesh = new THREE.Mesh( geometry, material );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					mesh.position.x = Math.floor( Math.random() * 20 - 10 ) * 20;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					mesh.position.y = Math.floor( Math.random() * 20 ) * 20 + 10;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					mesh.position.z = Math.floor( Math.random() * 20 - 10 ) * 20;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					scene.add( mesh );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					material.color.setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					objects.push( mesh );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				//</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				renderer = new THREE.WebGLRenderer();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				renderer.setClearColor( 0xffffff );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				renderer.setSize( window.innerWidth, window.innerHeight );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				document.body.appendChild( renderer.domElement );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				//</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				window.addEventListener( 'resize', onWindowResize, false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			function onWindowResize() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				camera.aspect = window.innerWidth / window.innerHeight;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				camera.updateProjectionMatrix();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				renderer.setSize( window.innerWidth, window.innerHeight );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			function animate() {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				requestAnimationFrame( animate );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				controls.isOnObject( false );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				ray.ray.origin.copy( controls.getObject().position );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				ray.ray.origin.y -= 10;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				var intersections = ray.intersectObjects( objects );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				if ( intersections.length &gt; 0 ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					var distance = intersections[ 0 ].distance;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					if ( distance &gt; 0 &amp;&amp; distance &lt; 10 ) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">						controls.isOnObject( true );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">					}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				controls.update();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				renderer.render( scene, camera );</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;/body&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/html&gt;</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"></td></tr></tbody></table></body></html>